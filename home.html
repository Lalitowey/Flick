<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
    <div class="topnav">
        <div class="header">
            <img src="flickworld.png" alt="logo" class="center"/>
        </div>
    </div>
</head>

<link href="homestyle.css" rel="stylesheet" />

<body>
        <nav class="navbar">
            <div class="hamburger-menu">
                <div class = "line line-1"></div>
                <div class = "line line-2"></div>
                <div class = "line line-3"></div>
            </div>
            <ul class="nav-list">
                <p id="user-info" class="nav-link"></p>
                <li class ="nav-item">
                <a href="#" class = "nav-link" id = "signOut" >Sign out</a>
                </li>
                <li class ="nav-item">
                <a href="#" class = "nav-link" id="deleteAccount" >Delete Account</a>
                </li>
            </ul>
        </nav>
    </div>   

<div class="bottom-contanier">
    <div class="left-container">
        <div class="sidenav">               <!-- These are the selectables on the sidebar -->
        <a href="#">About</a>
        <a href="#">Services</a>
        <a href="#">Clients</a>
        <a href="#">Contact</a>
        </div>
    </div>
    <div class="right-container">
        <h2></h2>
        <div class="poster-container" id="poster-container" class="center">
            <!-- Movie posters will be inserted here dynamically -->
        </div>
        <script src="homeindex.js"></script>

            <a div class="button-container">
                <button class="button dislike">➖</button>
                <button class="button like">➕</button>
            </a>
        </div>
    </div>
</div>
    

</body>

<script>
    const menuIcon = document.querySelector
(".hamburger-menu");
const navbar = document.querySelector(".navbar");

menuIcon.addEventListener("click", () => {
navbar.classList.toggle("change");
})      
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getDatabase, ref, remove } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";
import { getAuth, onAuthStateChanged, signOut  } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";

const firebaseConfig = {
apiKey: "AIzaSyCrXnG6H615rquhLI-hamYrz2GgLrflf2A",
authDomain: "flicker-8a847.firebaseapp.com",
databaseURL: "https://flicker-8a847-default-rtdb.firebaseio.com",
projectId: "flicker-8a847",
storageBucket: "flicker-8a847.appspot.com",
messagingSenderId: "24731055597",
appId: "1:24731055597:web:641a8977ab552fd98de3e4"
 };

const app = initializeApp(firebaseConfig);
const database = getDatabase(app);
const auth = getAuth();

const signOutButton = document.getElementById('signOut');
const deleteAccountButton = document.getElementById('deleteAccount');
const userInfoElement = document.getElementById('user-info');

// Add an event listener to check the authentication state
onAuthStateChanged(auth, (user) => {
if (user) {
  // User is signed in
  const uid = user.uid;
  userInfoElement.textContent = `Logged in as: ${user.email}`;

  // Event listener for signing out
signOutButton.addEventListener('click', () => {   
  signOut(auth).then(() => {
    // Sign-out successful

  alert('User logged out');
  window.location.href = 'login.html';

  }).catch((error) => {
      // Handle sign-out error
      
  const errorMessage = error.message;
  alert(errorMessage);

    });
  });


// Event listener for deleting the account
deleteAccountButton.addEventListener('click', () => {
// Check if the user is signed in
if (user) {
// Reference to the user's data in the database
const userRef = ref(database, `users/${user.uid}`);

// Delete the user's data from the database
remove(userRef)
  .then(() => {
    // Data deletion successful

    // Now, delete the user's account
    user.delete()
      .then(() => {
        // Account deletion successful
        alert('Account deleted');
        window.location.href = 'login.html'; // Replace with your login page URL
      })
      .catch((error) => {
        // Handle account deletion error
        const errorMessage = error.message;
        alert(errorMessage);
      });
  })
  .catch((error) => {
    // Handle data deletion error
    const errorMessage = error.message;
    alert(errorMessage);
  });
} else {
// User is not signed in, handle accordingly
alert('User is not signed in');
}
});
} else {
  // User is signed out
  userInfoElement.textContent = 'Not logged in';

  window.location.href = 'login.html'; // Replace with your login page URL

}
});

</script>

</html>
